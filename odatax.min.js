let ns=function(){function e(e){if("object"==typeof e&&null!=e){void 0!==(e=function(e){void 0===e.url&&(e.url="");void 0===e.localObj&&(e.localObj={});void 0===e.localObj.url&&(e.localObj.url="");e.url=""!=e.url?e.url:e.localObj.url,""==e.url&&m({alertmsg:"url is undefined",alertstatus:4});void 0!==e.emptyUrlParm&&1==e.emptyUrlParm&&window.history.pushState(null,null,window.location.pathname);void 0!==e.emptyUrlHash&&1==e.emptyUrlHash&&window.history.pushState(null,null,window.location.href.split("#")[0]);void 0!==e.setUrlParm&&window.history.pushState("","","?"+e.setUrlParm);void 0!==e.setUrlHash&&window.history.pushState("","","#"+e.setUrlHash);void 0!==e.setUrlDirectory&&window.history.pushState("","",e.setUrlDirectory);void 0!==e.goToUrl&&(window.location.href=e.goToUrl);void 0!==e.popstate&&!0===e.popstate&&(void 0!==e.localObj.event&&delete e.localObj.event,window.history.pushState({ref:e.localObj},"",""),window.addEventListener("popstate",function(t){ns.postData(e.localObj)}));return e}(e)).emptyElement&&e.emptyElement.forEach(function(e){document.querySelectorAll(e).forEach(e=>{e.innerHTML=""})}),void 0!==e.removeElement&&e.removeElement.forEach(function(e){document.querySelectorAll(e).forEach(e=>{e.remove()})});let i=!1;for(let[l,s]of Object.entries(e))switch("object"==typeof s&&null!==s&&(s.url=e.url),l){case"navBody":i=!0,t(s);break;case"table":s.localObj=e.localObj,i=!0,d(s);break;case"list":s.localObj=e.localObj,i=!0,a(s);break;case"form":s.localObj=e.localObj,i=!0,n(s);break;case"dialogbox":s.localObj=e.localObj,i=!0,o(s);break;case"html":i=!0,r(s)}}else m({alertmsg:"No results found",alertstatus:2});var l=document.querySelectorAll("[data-buttonid]");for(i=0;i<l.length;i++)l[i].addEventListener("click",function(t){y({fetchID:t.target.getAttribute("data-buttonid"),url:e.url})})}function t(e){void 0===e.nav&&(e.nav={}),void 0===e.body&&(e.body={});let t=document.createElement("div"),a=document.createElement("span"),n=document.createElement("ul"),o=document.createElement("div"),i=document.createElement("div");if(document.getElementById("o-wrapper"))var d=document.getElementById("o-wrapper");else(d=document.createElement("div")).setAttribute("id","o-wrapper");if(Object.keys(e.nav).length>0){"function"==typeof clickFunc&&t.removeEventListener("click",clickFunc,!1),document.querySelectorAll("#o-nav").forEach(e=>e.remove()),a.setAttribute("style","cursor:pointer;font-size: 2em;"),a.setAttribute("id","o-bars-nav"),a.innerHTML="&#9776;",t.setAttribute("id","o-nav"),t.setAttribute("style","width:98%;"),n.setAttribute("style","display:flex;justify-content:center;align-items: stretch;list-style-type:none;");for(let t=0;t<e.nav.text.length;t++){let a=document.createElement("li");a.setAttribute("style","margin:5px;"),a.innerHTML='<a class="o-links" href="javascript:void(0);" style="text-decoration:none;" data-linkid="'+e.nav.id[t]+'">'+e.nav.text[t]+"</a>",n.appendChild(a)}t.appendChild(a),t.appendChild(n),document.body.appendChild(t)}if(Object.keys(e.body).length>0){d.setAttribute("style","display: flex;width:98%; height:85%;padding:1.2em;");var r="100%",l="20%";if(void 0!==e.body.side&&(document.querySelectorAll("#o-side").forEach(e=>e.remove()),o.id="o-side",o.style.padding="20px",o.innerHTML=e.body.side,d.appendChild(o),r="80%"),void 0!==e.body.main&&(document.querySelectorAll("#o-main").forEach(e=>e.remove()),i.id="o-main",i.style.margin="20px",i.innerHTML=e.body.main,d.appendChild(i)),document.body.appendChild(d),void 0!==e.body.footer){document.querySelectorAll("#o-footer").forEach(e=>e.remove());let t=document.createElement("div");t.id="o-footer",t.setAttribute("style","position: fixed;bottom: 0;left: 0;right: 0;z-index: 2;text-align:center;padding: 4px 15px; color: #666;"),t.innerHTML=e.body.footer,document.body.appendChild(t)}}let s=window.matchMedia("(max-width: 700px)");function c(e){e.matches?(d.style.flexDirection="column",i.style.flex="100%",o.style.flex="100%",n.style.flexDirection="column",n.style.display="none",a.style.display="block"):(d.style.flexDirection="row",i.style.flex=r,o.style.flex=l,n.style.flexDirection="row",n.style.display="flex",a.style.display="none")}c(s),s.addListener(c),a.addEventListener("click",function(e){"flex"==n.style.display?n.style.display="none":n.style.display="flex"},!1),t.addEventListener("click",clickFunc=function(){if(event.stopPropagation(),event.target.matches(".o-links")||event.target.parentNode.matches(".o-links")){y({fetchID:event.target.getAttribute("data-linkid")||event.target.parentNode,url:e.url,dataOrder:"nav",event:event})}},!1)}function a(e){void 0===e.data&&(e.data={}),void 0===e.fetchID&&(e.fetchID=""),void 0===e.loadTo&&(e.loadTo=""),void 0===e.settings&&(e.settings={}),void 0===e.data.liMain&&(e.data.liMain=[]),void 0===e.data.liSub&&(e.data.liSub=[]),void 0===e.data.liSubText&&(e.data.liSubText=[]),void 0===e.data.liSubID&&(e.data.liSubID=[]);var t=document.createElement("div");let a=document.createElement("ul");if(""!=e.loadTo)if(document.getElementById(e.loadTo))t=document.getElementById(e.loadTo);else m({alertmsg:'Could not find the "loadTo" id',alertstatus:4});else{var n="o-list";if(""!=e.localObj.subDataID&&(n=n+"-"+e.localObj.subDataID),document.getElementById(n))var t=document.getElementById(n);else(t=document.createElement("div")).setAttribute("id",n),document.getElementById("o-main")?document.getElementById("o-main").appendChild(t):document.body.appendChild(t)}t.innerHTML=e.data.headtitle;for(let[a,n]of Object.entries(e.settings))switch(a){case"search":if(void 0===e.localObj.search){let e=document.createElement("div");e.innerHTML='<input type="text" class="o-lisearch" style="width:100%;" placeholder="Search..." title="Search" value="">',t.appendChild(e)}}a.setAttribute("style","list-style-type: none;padding: 0;margin: 0;");for(let t=0;t<Object.keys(e.data.liMain).length;t++){let n=document.createElement("li");n.setAttribute("class","o-listMain"),n.setAttribute("style","border: 1px solid #ddd;padding: 5px;cursor:pointer;");let i=!1;for(let a=0;a<e.data.liSub.length;a++)if(e.data.liMain[t].id===e.data.liSub[a].mainid){if(!i){n.setAttribute("class","o-list-toggle"),n.innerHTML='<span class="o-listText">'+e.data.liMain[t].text+'</span><span class="o-listIcon" style="float:right;">&#10010;</span>';var o=document.createElement("ul");o.setAttribute("style","list-style-type: none;padding: 0;margin:10px 0 0 0;display:none;"),o.setAttribute("class","o-sub-toggle"),i=!0}let d=document.createElement("li");d.setAttribute("style","border: 1px solid #ddd;padding: 5px;cursor:pointer;"),d.setAttribute("class","o-list-link"),d.setAttribute("data-liSubID",e.data.liSub[a].id),d.innerHTML=e.data.liSub[a].text+'<span class="o-listIcon" style="float:right;">&#10095;</span>',o.appendChild(d)}i&&n.appendChild(o),i||(n.setAttribute("class","o-list-link"),n.setAttribute("data-liMainID",e.data.liMain[t].id),n.innerHTML='<span class="o-listText">'+e.data.liMain[t].text+'</span><span class="o-listIcon" style="float:right;">&#10095;</span>'),a.appendChild(n)}t.appendChild(a),"function"==typeof liClickFunc&&t.removeEventListener("click",liClickFunc,!1),"function"==typeof liKeyupFunc&&t.removeEventListener("click",liKeyupFunc,!1),t.addEventListener("click",liClickFunc=function(){if(event.stopPropagation(),event.target.matches(".o-list-link")||event.target.parentNode.matches(".o-list-link")){y({liMainID:void 0!==event.target.getAttribute("data-liMainID")?event.target.getAttribute("data-liMainID"):"",liSubID:void 0!==event.target.getAttribute("data-liSubID")?event.target.getAttribute("data-liSubID"):"",url:e.url,dataOrder:"list",fetchID:e.fetchID,event:event})}if(event.target.matches(".o-list-toggle")||event.target.parentNode.matches(".o-list-toggle")){let e=event.target.querySelector(".o-sub-toggle")||event.target.parentNode.querySelector(".o-sub-toggle"),t=event.target.querySelector(".o-listIcon")||event.target.parentNode.querySelector(".o-listIcon");"none"==e.style.display?(e.style.display="block",t.innerHTML="&#9866;"):(e.style.display="none",t.innerHTML="&#10010;")}},!1),t.addEventListener("keyup",liKeyupFunc=function(){if(event.target.matches(".o-lisearch")){let e,t,n,o;for(e=event.target.value.toUpperCase(),t=a.querySelectorAll("span.o-listText"),n=0;n<t.length;n++)(o=""!=t[n].textContent||""!=t[n].innerText?t[n].textContent||t[n].innerText:"").toUpperCase().indexOf(e)>-1?t[n].parentNode.closest("li").style.display="":t[n].parentNode.closest("li").style.display="none"}},!1)}function n(e){void 0===e.data&&(e.data={}),void 0===e.fetchID&&(e.fetchID=""),void 0===e.loadTo&&(e.loadTo=""),void 0===e.settings&&(e.settings={}),void 0===e.data.headtitle&&(e.data.headtitle=""),void 0===e.data.foottitle&&(e.data.foottitle=""),void 0===e.data.columns&&(e.data.columns={}),void 0===e.data.rows&&(e.data.rows=[]),void 0===e.settings.subDataID&&(e.settings.subDataID=0),void 0===e.settings.buttons&&(e.settings.buttons={}),void 0===e.data.select&&(e.data.select={}),void 0===e.data.radio&&(e.data.radio={});let t=s(e);document.querySelectorAll(".o-form").forEach(e=>{e.remove()});let a=document.createElement("div");a.setAttribute("class","o-form");let n=document.createElement("div");n.innerHTML=e.data.headtitle;let o=document.createElement("div");o.innerHTML=e.data.foottitle;let i=document.createElement("div");if(i.setAttribute("style","display: flex;justify-content:center;"),Object.keys(e.settings.buttons).length>0)for(const[t,a]of Object.entries(e.settings.buttons)){let e=document.createElement("a");e.setAttribute("href","javascript:void(0);"),e.setAttribute("class","o-dialogbtn"),e.setAttribute("data-btnrole",t),e.style.margin="10px",e.innerHTML=a,i.appendChild(e)}a.appendChild(n),a.appendChild(t),a.appendChild(i),a.appendChild(o),""!=e.loadTo?document.getElementById(e.loadTo)?document.getElementById(e.loadTo).appendChild(a):m({alertmsg:'Could not find the "loadTo" id',alertstatus:4}):document.getElementById("o-main")?document.getElementById("o-main").appendChild(a):document.body.appendChild(a);let d=""!=e.fetchID?e.fetchID:e.localObj.fetchID;a.obj={url:e.url,fetchID:d},a.table=t,a.addEventListener("click",l,!1)}function o(e){void 0===e.data&&(e.data={}),void 0===e.fetchID&&(e.fetchID=""),void 0===e.loadTo&&(e.loadTo=""),void 0===e.settings&&(e.settings={}),void 0===e.data.headtitle&&(e.data.headtitle=""),void 0===e.data.foottitle&&(e.data.foottitle=""),void 0===e.data.columns&&(e.data.columns={}),void 0===e.data.rows&&(e.data.rows={}),void 0===e.settings.buttons&&(e.settings.buttons={}),void 0===e.data.select&&(e.data.select={}),void 0===e.data.radio&&(e.data.radio={});let t="";void 0!==e.data.id&&(t=e.data.id),Object.keys(e.data.rows).length>0&&void 0!==e.data.rows[0].id&&(t=e.data.rows[0].id);let[a,n]=function(){if(null!=document.querySelector(".o-dialogFrame")){let e=document.querySelectorAll(".o-dialogFrame");e.forEach(e=>{e.removeEventListener("click",l,!1),e.parentNode.removeChild(document.querySelector(".o-dialogFrame"))})}let e=document.createElement("div");e.setAttribute("class","o-dialogFrame");let t=document.createElement("div");e.setAttribute("style","border-radius: 5px;border:solid thin #c5c5c5;padding:10px;display: inline-block;position: fixed;z-index: 9999;box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);min-width:200px;max-width:400px;background-color: #fff;"),t.setAttribute("style","display: flex;margin-bottom:5px;justify-content:space-between;cursor:move;padding:10;background:whitesmoke;");let a=document.createElement("div");a.innerHTML='<a href="javascript:void(0);" class="o-close">[close]</a>',t.appendChild(a),e.appendChild(t);var n=new Object;return n.obj=t,n.obj.addEventListener(v()?"touchstart":"mousedown",function(e){n.top=parseInt(n.obj.parentNode.offsetTop),n.left=parseInt(n.obj.parentNode.offsetLeft),n.oldx=n.x,n.oldy=n.y,n.drag=!0}),window.addEventListener(v()?"touchend":"mouseup",function(){n.drag=!1}),window.addEventListener(v()?"touchmove":"mousemove",function(e){n.x=e.clientX,n.y=e.clientY;let t=n.x-n.oldx,a=n.y-n.oldy;n.drag&&(n.obj.parentNode.style.left=n.left+t+"px",n.obj.parentNode.style.top=n.top+a+"px",e.preventDefault())}),[t,e]}(),o=s(e),i=""!=e.fetchID?e.fetchID:e.localObj.fetchID;n.obj={id:t,url:e.url,fetchID:i},n.table=o;let d=document.createElement("div");d.innerHTML=e.data.headtitle;let r=document.createElement("div");r.innerHTML=e.data.foottitle;let c=document.createElement("div");if(c.setAttribute("style","display: flex;justify-content:center;"),Object.keys(e.settings.buttons).length>0)for(const[a,n]of Object.entries(e.settings.buttons)){let e=document.createElement("a");e.setAttribute("href","javascript:void(0);"),e.setAttribute("class","o-dialogbtn"),e.setAttribute("data-btnrole",a),e.setAttribute("data-id",t),e.style.margin="10px",e.innerHTML=n,c.appendChild(e)}let u=document.createElement("div");u.setAttribute("style","min-height:150px;max-height:400px;height:100%;overflow:auto;"),u.appendChild(o),n.appendChild(u),n.appendChild(c),n.appendChild(r),a.prepend(d),function(e){document.body.appendChild(e),e.style.top=window.innerHeight/2-e.offsetHeight/2+"px",e.style.left=window.innerWidth/2-e.offsetWidth/2+"px"}(n),n.addEventListener("click",l,!1)}function d(e){void 0===e.data&&(e.data={}),void 0===e.fetchID&&(e.fetchID=""),void 0===e.subTable&&(e.subTable=!1),void 0===e.loadTo&&(e.loadTo=""),void 0===e.settings&&(e.settings={}),void 0===e.data.headtitle&&(e.data.headtitle=""),void 0===e.data.foottitle&&(e.data.foottitle=""),void 0===e.data.columns&&(e.data.columns={}),void 0===e.data.rows&&(e.data.rows=[]),void 0===e.settings.subDataID&&(e.settings.subDataID=0),void 0===e.settings.tabs&&(e.settings.tabs=[]),void 0===e.settings.buttons&&(e.settings.buttons={}),void 0===e.settings.heighlight&&(e.settings.heighlight="none");let t=document.createElement("div"),a=document.createElement("div"),n=document.createElement("table"),o=document.createElement("div"),d=document.createElement("div"),r=document.createElement("div");var l=document.createElement("div");let s=!1;var c=new Array,v=new Array;if(1==e.subTable?null==document.querySelector("#o-subTable")?l.setAttribute("id","o-subTable"):(l=document.getElementById("o-subTable"),s=!0):null==document.querySelector("#o-table")?l.setAttribute("id","o-table"):(l=document.getElementById("o-table"),s=!0),s||(""!=e.loadTo?document.getElementById(e.loadTo)?document.getElementById(e.loadTo).appendChild(l):m({alertmsg:'Could not find the "loadTo" id',alertstatus:4}):document.getElementById("o-main")?document.getElementById("o-main").appendChild(l):document.body.appendChild(l)),t.setAttribute("class","o-headtitle"),t.innerHTML=e.data.headtitle,d.setAttribute("class","o-foottitle"),d.innerHTML=e.data.foottitle,Object.keys(e.settings).length>0)for(let[t,n]of Object.entries(e.settings))switch(t){case"search":null==l.querySelector(".o-tablesearch")?(a.setAttribute("class","o-tablesearch"),a.innerHTML='<input type="text" id="search" placeholder="Search..." title="Search" value="" autofocus>'):a=l.querySelector(".o-tablesearch");break;case"pages":let n=Math.ceil(e.settings[t].totalRows/e.settings[t].rowsPerPage);o.appendChild(p(e.settings[t].currentPage,n));break;case"tabs":if(null==l.querySelector(".o-tab")){r.setAttribute("class","o-tabs"),r.setAttribute("style","margin-top:10px;");for(let t=0;t<e.settings.tabs.length;t++){let a=document.createElement("a");a.setAttribute("href","javascript:void(0)"),a.setAttribute("class","o-tab"),a.setAttribute("data-tab",t),a.setAttribute("style","margin-right:5px;"),a.innerHTML=e.settings.tabs[t],r.appendChild(a)}}else r=l.querySelector(".o-tabs");break;case"buttons":if(Object.keys(e.settings.buttons).length>0){if(e.settings.buttons.td instanceof Object)for(const[t,a]of Object.entries(e.settings.buttons.td))c.push('<a href="javascript:void(0);" class="o-btn" data-btnrole="'+t+'">'+a+"</a>");if(e.settings.buttons.th instanceof Object)for(const[t,a]of Object.entries(e.settings.buttons.th))v.push('<a href="javascript:void(0);" class="o-btn" data-btnrole="'+t+'">'+a+"</a>")}}if(Object.keys(e.data.columns).length>0){let t=document.createElement("tr");for(let[a,n]of Object.entries(e.data.columns)){let e=document.createElement("th");switch(n[1]){case"order":let t="asc";a==h("orderby")&&(t=h("order"),g("orderby","")),e.innerHTML='<a href="javascript:void(0);" data-order="'+t+'" data-orderby="'+a+'">'+n[0]+" &#x21C5;</a>";break;default:e.innerHTML=n[0]}t.appendChild(e)}let a=document.createElement("th");v.forEach(e=>{a.innerHTML=e}),c.length>1&&a.setAttribute("colspan",c.length),t.appendChild(a),n.appendChild(t)}if(e.data.rows.length>0)for(let t=0;t<Object.keys(e.data.rows).length;t++){let a=document.createElement("tr");for(let n in e.data.columns){let o=document.createElement("td");switch(n[1]){case"date":o.innerHTML=dateShort(e.data.rows[t][n]);break;case"time":o.innerHTML=convertTime24to12(e.data.rows[t][n]);break;case"status":o.innerHTML=1==e.data.rows[t][n]?'<span style="color:green;">ready</span>':0==e.data.rows[t][n]?'<span style="color:orange;">pending</span>':'<span style="color:red;">failed</span>';break;case"color":o.innerHTML=b(e.data.columns[n],e.data.rows[t][n]);break;default:o.innerHTML=e.data.rows[t][n]}a.appendChild(o)}c.forEach(e=>{let t=document.createElement("td");t.innerHTML=e,a.appendChild(t)});let o=void 0===e.data.rows[t].id?"":e.data.rows[t].id;a.setAttribute("data-id",o),a.setAttribute("data-subdataid",e.settings.subDataID),a.setAttribute("data-dataid",e.fetchID),n.appendChild(a)}"function"==typeof clickFunc&&l.removeEventListener("click",clickFunc,!1),"function"==typeof keyupFunc&&l.removeEventListener("keyup",keyupFunc,!1),l.addEventListener("click",clickFunc=function(){if(event.stopPropagation(),"a"===event.target.tagName.toLowerCase()||"a"===event.target.parentNode.tagName.toLowerCase()){if(event.target.hasAttribute("data-page")){let t,a,n=event.target.getAttribute("data-page"),o=parseInt(l.querySelector(".currentpage").getAttribute("data-page"));if(null!=l.querySelector("#search")&&(a=l.querySelector("#search").value),"next"==n||"prev"==n?("prev"==n&&(t=o-1),"next"==n&&(t=o+1)):t=parseInt(n),u(t))m({alertmsg:"Cannot identify page, missing info",alertstatus:2});else{y({page:parseInt(t),search:a,url:e.url,fetchID:e.fetchID,tab:h("tab"),mainid:h("mainid"),event:event})}}if(event.target.hasAttribute("data-order")){let t=event.target.getAttribute("data-order"),a=event.target.getAttribute("data-orderby"),n="asc"==t?"desc":"asc";g("orderby",a),g("order",n),y({order:t,orderby:a,url:e.url,fetchID:e.fetchID,tab:h("tab"),mainid:h("mainid"),event:event})}if(event.target.matches(".o-btn")||event.target.parentNode.matches(".o-btn")){let t=event.target.parentNode.closest("tr").getAttribute("data-id"),a=event.target.getAttribute("data-btnrole")||event.target.parentNode.getAttribute("data-btnrole");if("subdata"!=a){y({id:t,url:e.url,fetchID:e.fetchID,dataOrder:a,tab:h("tab"),mainid:h("mainid"),event:event})}else{g("mainid",parseInt(t));let a=0;if(e.settings.tabs.length>0&&(null!=l.querySelector(".o-active-tab")?a=l.querySelector(".o-active-tab").getAttribute("data-tab"):(l.querySelector(".o-tab").classList.add("o-active-tab"),l.querySelector(".o-tab").style.background=e.settings.heighlight),g("tab",parseInt(a))),u(t))m({alertmsg:"Cannot identify this row, missing id",alertstatus:2});else{y({mainid:t,url:e.url,fetchID:e.fetchID,subDataID:e.settings.subDataID,tab:a,dataOrder:"subdata",event:event});let n=event.target.parentNode.closest("table").getElementsByTagName("tr");for(let e=0;e<n.length;e++)null!=n[e].querySelector(".o-active-sub")&&n[e].querySelector(".o-active-sub").classList.remove("o-active-sub");if(event.target.matches(".o-subdata")?event.target.classList.add("o-active-sub"):event.target.parentNode.classList.add("o-active-sub"),""!=e.settings.heighlight){for(let e=0;e<n.length;e++)n[e].style.background="";event.target.parentNode.closest("tr").style.background=e.settings.heighlight}}}}if(event.target.matches(".o-tab")){for(tablinks=l.getElementsByClassName("o-tab"),i=0;i<tablinks.length;i++)tablinks[i].classList.remove("o-active-tab"),tablinks[i].style.background="";event.target.classList.add("o-active-tab"),event.target.style.background=e.settings.heighlight,tab=event.target.getAttribute("data-tab"),g("tab",parseInt(tab));let t=0;if(e.data.rows.length>0){if(null!=l.querySelector(".o-active-sub"))t=l.querySelector(".o-active-sub").parentNode.closest("tr").getAttribute("data-id");else{let a=l.querySelector('a[data-btnrole="subdata"]');a.classList.add("o-active-sub"),a.parentNode.closest("tr").style.background=e.settings.heighlight,t=a.parentNode.closest("tr").getAttribute("data-id")}g("mainid",parseInt(t))}if(u(tab)||u(t))m({alertmsg:"Cannot identify this tab, missing tab id",alertstatus:2});else{y({mainid:parseInt(t),url:e.url,fetchID:e.fetchID,subDataID:e.settings.subDataID,dataOrder:"tab",tab:tab,event:event})}}}},!1),l.addEventListener("keyup",keyupFunc=function(){if(event.stopPropagation(),"input"===event.target.tagName.toLowerCase()&&"search"==event.target.id&&13===event.keyCode){y({search:event.target.value,url:e.url,fetchID:e.fetchID,tab:h("tab"),event:event})}},!1),l.innerHTML="",l.appendChild(t),l.appendChild(a),l.appendChild(n),l.appendChild(d),l.appendChild(o),l.appendChild(r)}function r(e){void 0===e.data&&(e.data=""),void 0===e.loadTo&&(e.loadTo="");let t=document.createElement("div");t.innerHTML=e.data,""!=e.loadTo?document.getElementById(e.loadTo)?document.getElementById(e.loadTo).appendChild(t):m({alertmsg:'Could not find the "loadTo" id',alertstatus:4}):document.getElementById("o-main")?document.getElementById("o-main").appendChild(t):document.body.appendChild(t)}function l(e){e.stopPropagation();let t=e.currentTarget.obj,a=e.currentTarget.table,n={};if(e.target.matches(".o-close")&&(document.removeEventListener("click",l,!1),document.querySelectorAll(".o-dialogFrame").forEach(e=>{e.remove()})),e.target.matches(".o-toggleBtn")&&(0==e.target.getAttribute("data-toggleValue")?(e.target.value="ON",e.target.setAttribute("data-toggleValue","1"),e.target.style.color="green"):(e.target.value="OFF",e.target.setAttribute("data-toggleValue","0"),e.target.style.color="red")),e.target.matches(".o-dialogbtn")||e.target.parentNode.matches(".o-dialogbtn")){e.target.getAttribute("data-id")||e.target.parentNode.getAttribute("data-id");let o=e.target.getAttribute("data-btnrole")||e.target.parentNode.getAttribute("data-btnrole");if("delete"!=o){document.querySelectorAll(".o-err").forEach(e=>{e.classList.remove("o-err")});let e=!0,i=a.querySelectorAll("[data-read]");for(let t=0;t<i.length;t++){switch(i[t].nodeName){case"INPUT":if("checkbox"==i[t].type)n[i[t].getAttribute("data-read")]=i[t].checked;else if("button"==i[t].type)n[i[t].getAttribute("data-read")]=i[t].getAttribute("data-toggleValue");else if("email"==i[t].type){if(!i[t].value.match(/\S+@\S+\.\S+/)){c(i[t]),e=!1,m({alertmsg:"invalid email address",alertstatus:4});break}n[i[t].getAttribute("data-read")]=i[t].value}else if("password"==i[t].type){if("repassword"!=i[t].getAttribute("data-read"))if(i.length<=t+1)n[i[t].getAttribute("data-read")]=i[t].value;else if("repassword"==i[t+1].getAttribute("data-read")){if(i[t].value!==i[t+1].value){c(i[t]),e=!1,m({alertmsg:"passwords do not match",alertstatus:4});break}n[i[t].getAttribute("data-read")]=i[t].value}else n[i[t].getAttribute("data-read")]=i[t].value}else n[i[t].getAttribute("data-read")]=i[t].value;break;case"SELECT":void 0!==i[t].options[i[t].selectedIndex]?i[t].multiple?n[i[t].getAttribute("data-read")]=Array.from(i[t].options).filter(e=>e.selected).map(e=>e.value).join():n[i[t].getAttribute("data-read")]=i[t].options[i[t].selectedIndex].value:n[i[t].getAttribute("data-read")]="";break;case"DIV":let a=i[t].getAttribute("data-read");n[a]=(i[t].querySelector('input[name="'+a+'"]:checked')||{}).value||"";break;case"TEXTAREA":n[i[t].getAttribute("data-read")]=i[t].value}if((i[t].required||"required"==i[t].getAttribute("required"))&&(u(n[i[t].getAttribute("data-read")])||"null"==n[i[t].getAttribute("data-read")])){c(i[t]),e=!1,m({alertmsg:i[t].parentNode.previousSibling.innerHTML+" is required",alertstatus:4});break}}1==e&&(t.dataOrder=o,t.mainid=h("mainid"),t.tab=h("tab"),t.data=n,y(t))}else{(function(e){null!=e&&""!==e||(e="Are you sure you want to delete this?");return!!confirm(e)})()&&(t.mainid=h("mainid"),t.tab=h("tab"),t.dataOrder=o,y(t),e.cancelBubble=!0,document.removeEventListener("click",l,!1),document.querySelectorAll(".o-dialogFrame").forEach(e=>{e.remove()}))}}}function s(e){var t=document.createElement("table");t.setAttribute("class",""),t.style.width="100%";const a=0===Object.keys(e.data.rows).length;for(const[c,u]of Object.entries(e.data.columns)){var n=document.createElement("tr"),o=document.createElement("select");o.setAttribute("data-read",c);var i=document.createElement("input");i.setAttribute("data-read",c);var d=document.createElement("textarea");d.setAttribute("data-read",c);var r=document.createElement("div");r.setAttribute("style","display:flex; flex-direction: column;"),r.setAttribute("data-read",c),(l=document.createElement("td")).innerHTML=u[0],n.appendChild(l);for(let t=1;t<u.length;t++){"required"==u[t]&&(o.required=!0,i.required=!0,d.required=!0,r.setAttribute("required","required"));var l=document.createElement("td");switch(u[t]){case"select":var s=!1;if(e.data.select.hasOwnProperty(c))for(let t=0;t<Object.keys(e.data.select[c]).length;t++){let n=document.createElement("option");n.value=e.data.select[c][t].value,n.text=e.data.select[c][t].text,a||e.data.select[c][t].value==e.data.rows[0][c]&&(n.selected="selected",s=!0),o.appendChild(n)}else o.innerHTML="<option>missing options!</option>";a||0==s&&(option=document.createElement("option"),option.selected="selected",option.value=e.data.rows[0][c],option.text=e.data.rows[0][c],o.appendChild(option)),l.appendChild(o);break;case"multiple":if(o.multiple=!0,!a);e.data.rows[0][c]instanceof Array?selectedArr=e.data.rows[0][c]:selectedArr=e.data.rows[0][c].replace(/(^,)|(,$)/g,"").split(",");s=!1;if(e.data.select.hasOwnProperty(c))for(let t=0;t<Object.keys(e.data.select[c]).length;t++){let n=document.createElement("option");n.value=e.data.select[c][t].value,n.text=e.data.select[c][t].text,a||selectedArr.forEach(a=>{a==e.data.select[c][t].value&&(n.selected=!0,s=!0)}),o.appendChild(n)}else o.innerHTML="<option>missing options!</option>";a||0==s&&(option=document.createElement("option"),option.selected=!0,option.value=e.data.rows[0][c],option.text=e.data.rows[0][c],o.appendChild(option)),l.appendChild(o);break;case"radio":if(e.data.radio.hasOwnProperty(c))for(let t=0;t<Object.keys(e.data.radio[c]).length;t++){let n=document.createElement("div"),o=document.createElement("label"),i=document.createElement("input");i.type="radio",i.name=c,i.value=e.data.radio[c][t],o.innerHTML=e.data.radio[c][t],o.setAttribute("style","text-transform:capitalize;"),a||e.data.radio[c][t]==e.data.rows[0][c]&&(i.checked="checked"),n.appendChild(i),n.appendChild(o),r.appendChild(n)}else r.innerHTML='<b style="color:red;">missing radios!</b>';l.appendChild(r);break;case"checkbox":a||(i.checked=1==e.data.rows[0][c]),i.type="checkbox",l.appendChild(i);break;case"textarea":a||(d.value=e.data.rows[0][c]),l.appendChild(d);break;case"number":a||(i.value=e.data.rows[0][c]),i.type="number",l.appendChild(i);break;case"disabled":let n="N/A";a||(n=e.data.rows[0][c]),i.value=h(c)||n,i.type="text",i.disabled=!0,l.appendChild(i);break;case"autoGenerate":i.value=e.data.rows[0][c],i.type="text",l.appendChild(i);break;case"toggleButton":let p=0;a||(p=e.data.rows[0][c]);let b=1==p?'<span style="color:green;">ON</span>':'<span style="color:red;">OFF</span>';i.value=b,i.type="button",i.setAttribute("class","o-toggleBtn"),i.setAttribute("data-toggleValue",p),l.appendChild(i);break;case"date":a||(i.value=e.data.rows[0][c]),i.id=c,i.type="date",l.appendChild(i);break;case"time":a||(i.value=e.data.rows[0][c]),i.id=c,i.type="time",l.appendChild(i);break;case"email":a||(i.value=e.data.rows[0][c]),i.id=c,i.type="email",l.appendChild(i);break;case"password":i.id=c,i.type="password","function"==typeof keyupFuncPass&&document.removeEventListener("keyup",keyupFuncPass,!1),i.addEventListener("keyup",keyupFuncPass=function(){event.stopPropagation(),13===event.keyCode&&document.querySelector(".o-dialogbtn").click()},!1),l.appendChild(i);break;default:a||(i.value=e.data.rows[0][c]),i.id=c,i.type="text",l.appendChild(i)}}n.appendChild(l),t.appendChild(n)}return t}function c(e){if(document.getElementById("o-err"))e.classList.add("o-err");else{let t=".o-err { outline: 1px solid red !important; }",a=document.head,n=document.createElement("style");n.type="text/css",n.appendChild(document.createTextNode(t)),n.setAttribute("id","o-err"),a.appendChild(n),e.classList.add("o-err")}}function u(e){return!(void 0!==(e+="")&&e&&0!==e.length&&""!==e&&/[^\s]/.test(e)&&!/^\s*$/.test(e)&&""!==e.replace(/\s/g,""))}function p(e,t){let a=e-3>0?e-3:1,n=[];for(let o=0;o<6&&a<t;o++)e==a?1!=a&&a!=t&&n.push('<a href="javascript:void(0)" class="o-nav currentpage" data-page="'+a+'"  style="text-decoration: none; font-weight:bold;">'+a+"</a>"):1!=a&&a!=t&&n.push('<a href="javascript:void(0)" class="o-nav" data-page="'+a+'">'+a+"</a>"),a++;t>1&&(5<e?(n.unshift("..."),n.unshift('<a href="javascript:void(0)" class="o-nav" data-page="1">1</a>')):1==e?n.unshift('<a href="javascript:void(0)" class="o-nav currentpage" data-page="1"  style="text-decoration: none;">1</a>'):n.unshift('<a href="javascript:void(0)" class="o-nav" data-page="1">1</a>'),t-3>e?(n.push("..."),n.push('<a href="javascript:void(0)" class="o-nav" data-page="'+t+'">'+t+"</a>")):t==e?n.push('<a href="javascript:void(0)" class="o-nav currentpage" data-page="'+t+'"  style="text-decoration: none;">'+t+"</a>"):n.push('<a href="javascript:void(0)" class="o-nav" data-page="'+t+'">'+t+"</a>"));let o=document.createElement("div");o.setAttribute("id","pagination"),o.setAttribute("style","display: flex; margin-top:20px; justify-content: space-between;");let i=document.createElement("div"),d=e==t||0==t?"":' | <a href="javascript:void(0)" class="o-nav" data-page="next">Next</a>',r=1==e||t<1?"":'<a href="javascript:void(0)" class="o-nav" data-page="prev">Prev</a> | ';i.innerHTML=r+n.join(" ")+d;let l=document.createElement("div");return l.innerHTML=" page: "+e+" of "+t,o.appendChild(i),o.appendChild(l),o}function b(e,t){let a="",n='<span style="color:'+e[2]+';">'+t+"</span>";switch(e[3]){case"max":a=t>e[4]?n:t;break;case"min":a=t<e[4]?n:t;break;case"max_min":a=t>e[4]||t<e[5]?n:t;break;default:a="N/A"}return a}function m(e){if(void 0===e){}u(e.alertmsg)&&(e.alertmsg="ERROR: 0"),u(e.alertstatus)&&(e.alertstatus=4);let t="border:1px solid tomato;",a="&#x2717;";switch(e.alertstatus){case 1:t="border:1px solid #2196F3 !important;",a="&#9432;";break;case 2:t="border:1px solid #ff9800 !important;",a="&#x26A0;";break;case 3:t="border:1px solid #4CAF50 !important;",a="&#x2713;"}if(null!=document.querySelector(".o-popalert")){document.querySelectorAll(".o-popalert").forEach(e=>{e.removeEventListener("click",r,!1),e.parentNode.removeChild(document.querySelector(".o-popalert"))})}let n=document.createElement("div");n.setAttribute("class","o-popalert");let o="bottom";v()&&(o="top"),n.setAttribute("style","min-width: 30%;padding: 20px;background-color:whitesmoke;color: #111;border-radius: 2px;padding: 16px;position: fixed;z-index: 999999;"+o+":0%; left: 50%;transform: translateX(-50%);box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);"+t),n.innerHTML=a+"  "+e.alertmsg,document.body.appendChild(n);let i=1,d=setInterval(function(){"top"==o?n.style.top=i+"%":n.style.bottom=i+"%",10==++i&&clearInterval(d)},5);var r=function(e){document.body.contains(n)&&(document.body.removeEventListener("click",r,!1),document.body.removeChild(n))};document.body.addEventListener("click",r,!1),setTimeout(r,5e3)}function h(e){let t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?t[2]:null}function g(e,t){document.cookie=e+"="+t}function v(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}}let f={};function y(t){void 0===t.url||""==t.url?m({alertmsg:'The "url" is not defined or it is empty',alertstatus:4}):(t.href=window.location.href,t.hash=window.location.hash,f.post(t.url,{objJson:t},function(a,n){void 0!==t.password&&delete t.password,console.log(a),void 0===a||null==a||0!=n?m({alertmsg:"Cannot reach the server or null returned! "+n,alertstatus:4}):(void 0!==a&&void 0!==t.localObj&&delete t.localObj,a.localObj=t,e(a),void 0!==a&&void 0!==a.alerts&&m(a.alerts))}))}return f.post=function(e,t,a){let n=document.createElement("div");n.setAttribute("style","position:fixed;top:0;width:100%;"),n.innerHTML='<svg version="1.1"class="svg-divider"xmlns="http://www.w3.org/2000/svg"xmlns:xlink="http://www.w3.org/1999/xlink"x="0px"y="0px"viewBox="0 0 80 3" xml:space="preserve"><rect x="1"fill="tomato"width="16"height=".1"><animate attributeName="x"attributeType="XML"values="1; 64; 1"begin="0s" dur="1.5s" repeatCount="indefinite" /></rect>',document.body.appendChild(n),"fetch"in window?f.fetch(e,a,t,n):f.ajax(e,a,t,n)},f.ajax=function(e,t,a,n){let o=new XMLHttpRequest;o.onreadystatechange=function(){4==this.readyState&&200==this.status?(t(JSON.parse(this.responseText),0),document.body.removeChild(n)):document.body.removeChild(n)},o.open("POST",e,!0),o.setRequestHeader("Content-type","application/json"),o.send(JSON.stringify(a))},f.fetch=function(e,t,a,n){fetch(e,{mode:"same-origin",credentials:"same-origin",method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}).then(e=>{if(e.ok)return e.json();throw new Error(e.status)}).catch(function(e){t(0,e)}).then(function(e){void 0!==e&&t(e,0),document.body.removeChild(n)})},{main:e,postData:y}}();
